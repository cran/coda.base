<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Marc Comas-Cufí" />

<meta name="date" content="2022-07-18" />

<title>Principal Balances</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Principal Balances</h1>
<h4 class="author">Marc Comas-Cufí</h4>
<h4 class="date">2022-07-18</h4>



<p><em>Principal balances</em> are defined as follows <span class="citation">(Pawlowsky-Glahn, Egozcue, and Tolosan-Delgado
2011)</span>:</p>
<blockquote>
<p>Given an <span class="math inline">\(n\)</span>-sample of a <span class="math inline">\(D\)</span>-part random composition, the set of
Principal Balances (PB) is a set of <span class="math inline">\(D-1\)</span> balances satisfying the following
conditions:</p>
<ul>
<li>Each sample PB is obtained as the projection of a sample composition
on a unitary composition or balancing element associated to the PB.</li>
<li>The first PB is the balance with maximum sample variance.</li>
<li>The <span class="math inline">\(i\)</span>-th PB has maximum
variance conditional to its balancing element being orthogonal to the
previous 1st, 2nd, …, <span class="math inline">\((i-1)\)</span>-th
balancing elements.</li>
</ul>
</blockquote>
<p>Because of the large number of possibilities, for a given
compositional sample, finding the PB is a computational demanding task.
<span class="citation">Martín-Fernández et al. (2017)</span> proposed
different approaches to deal with the calculation and approximation of
such type of basis. <code>coda.base</code> implements all methods
presented in <span class="citation">(Martín-Fernández et al.
2017)</span>.</p>
<p>To illustrate <code>coda.base</code> functionalities, we use the
following dataset:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda.base)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> parliament2017[,<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<p>consisting of parties in the 2017 Catalan Parliament Elections.</p>
<div id="exact-principal-balances" class="section level2">
<h2>Exact Principal Balances</h2>
<p><code>coda.base</code> can calculate the PB with the function
<code>pb_basis()</code>. Function <code>pb_basis()</code> needs the
parameter <code>method</code> to be set. To obtain the PB users needs to
set <code>method = &quot;exact&quot;</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>B1 <span class="ot">=</span> <span class="fu">pb_basis</span>(X, <span class="at">method =</span> <span class="st">&quot;exact&quot;</span>)</span></code></pre></div>
<p>Where the obtained sequential binary partition can be summarized with
the following sequential binary tree:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_balance</span>(B1)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">coordinates</span>(X, B1), <span class="dv">2</span>, var)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      pb1      pb2      pb3      pb4      pb5      pb6      pb7 </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.663216 0.085733 0.046135 0.044113 0.032890 0.028590 0.008179</span></span></code></pre></div>
<p>When <code>method</code> is set to <code>&quot;exact&quot;</code>, exhaustive
search is performed to obtain the PB. The time needed to calculate the
PB grows exponentially regarding the number of parts of <code>X</code>.
To iterate through all the possibilities, CoDaPack uses the algorithm
<span class="citation">Ruskey (1993)</span>. Currently, exhaustive
search can find the PB of a compositional data set with 20 parts in a
reasonable amount of time (5 minutes approximately).</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When the number of part is higher, the exact method should be
discarded in favor of other alternatives. Different alternatives are
available in <span class="citation">Pawlowsky-Glahn, Egozcue, and
Tolosan-Delgado (2011)</span> and <span class="citation">Martín-Fernández et al. (2017)</span>. Between these
alternatives, the once that can be implemented are agglomerate partition
approach based on the Ward method <span class="citation">Martín-Fernández et al. (2017)</span> and the
approximation based on a reduced approximation to the principal
components <span class="citation">(Martín-Fernández et al.
2017)</span>.</p>
</div>
<div id="ward-method-for-parts" class="section level2">
<h2>Ward Method for Parts</h2>
<p>For a composition <span class="math inline">\(X\)</span>, <span class="citation">Pawlowsky-Glahn, Egozcue, and Tolosan-Delgado
(2011)</span> proposed to build the variation array and use it to
produce a matrix distance. The variation array calculates the variance
between a pair of logratios.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">=</span> <span class="fu">as.dist</span>(<span class="fu">variation_array</span>(X, <span class="at">only_variation =</span> <span class="cn">TRUE</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>D</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            cs   jxcat     erc     psc   catsp     cup      pp</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; jxcat 0.62079                                                </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; erc   0.39636 0.08823                                        </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; psc   0.04887 0.53876 0.29338                                </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; catsp 0.06682 0.54951 0.29768 0.01636                        </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cup   0.48118 0.07179 0.05809 0.36163 0.35432                </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pp    0.12424 0.40944 0.20351 0.10318 0.14361 0.32193        </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; other 0.07018 0.56344 0.36363 0.07197 0.07462 0.37428 0.20308</span></span></code></pre></div>
<p>Combining pairs with lower variance, it is expected to get a final
merging with high variability.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>B2 <span class="ot">=</span> <span class="fu">pb_basis</span>(X, <span class="at">method =</span> <span class="st">&#39;cluster&#39;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_balance</span>(B2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">coordinates</span>(X, B2), <span class="dv">2</span>, var)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      pb1      pb2      pb3      pb4      pb5      pb6      pb7 </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.651569 0.097381 0.043659 0.043188 0.035838 0.029044 0.008179</span></span></code></pre></div>
</div>
<div id="constrained-pcs-algorithm" class="section level2">
<h2>Constrained PCs Algorithm</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>B3 <span class="ot">=</span> <span class="fu">pb_basis</span>(X, <span class="at">method =</span> <span class="st">&#39;constrained&#39;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_balance</span>(B3)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">coordinates</span>(X, B3), <span class="dv">2</span>, var)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      pb1      pb2      pb3      pb4      pb5      pb6      pb7 </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.663216 0.085733 0.046135 0.044113 0.032890 0.028590 0.008179</span></span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-fernandez2017" class="csl-entry">
Martín-Fernández, Josep A., Vera Pawlowsky-Glahn, Juan J. Egozcue, and
Raimon Tolosan-Delgado. 2017. <span>“Advances in Principal Balances for
Compositional Data.”</span> <em>Mathematical Geosciences</em> 50:
273–98. <a href="https://doi.org/10.1007/s11004-017-9712-z">https://doi.org/10.1007/s11004-017-9712-z</a>.
</div>
<div id="ref-pawlowsky2011" class="csl-entry">
Pawlowsky-Glahn, Vera, Juan J. Egozcue, and Raimon Tolosan-Delgado.
2011. <span>“Principal Balances.”</span> <em>In Egozcue JJ,
Tolosana-Delgado R, Ortego M (Eds) Proceedings of the 4th International
Workshop on Compositional Data Analysis, Girona, Spain</em>, 1–10.
</div>
<div id="ref-ruskey1993" class="csl-entry">
Ruskey, Frank. 1993. <span>“Simple Combinatorial Gray Codes Constructed
by Reversing Sublists.”</span> <em>Lecture Notes in Computer
Science</em> 762: 201–8. <a href="https://doi.org/10.1007/3-540-57568-5_250">https://doi.org/10.1007/3-540-57568-5_250</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
